<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GridGenius Paper</title>
    <!-- Ensure this path is correct relative to your HTML file -->
    <link rel="icon" type="image/png" href="assets/gglogo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        :root {
            --bg-dark: #121212; /* Even darker base */
            --bg-card: #1e1e1e; /* Slightly lighter card */
            --bg-card-subtle-gradient: linear-gradient(145deg, #232325, #1a1a1c);
            --text-primary: #eaeaeb;
            --text-secondary: #b0b0b5;
            --accent-yellow: #fde047;
            --accent-yellow-dark: #facc15;
            --accent-blue: #60a5fa;
            --border-color: #3a3a3c; /* Softer border */
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-med: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-glow: 0 0 20px rgba(253, 224, 71, 0.2), 0 0 40px rgba(253, 224, 71, 0.1);
            --shadow-card: 0 5px 15px rgba(0, 0, 0, 0.3);
            --shadow-card-hover: 0 8px 25px rgba(0, 0, 0, 0.4);
            --text-link-default: rgba(255, 255, 255, 0.85);
            --border-nav: rgba(255, 255, 255, 0.1);
            --bg-nav: rgba(18, 18, 18, 0.85); /* Match body bg slightly */
            --nav-blur: 10px;
            --nav-link-hover: var(--accent-yellow); /* Use brighter yellow for hover */
            --nav-height: 65px; /* Define nav height for scroll padding */
            --focus-outline-color: var(--accent-blue); /* For focus styles */
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }

        html { scroll-padding-top: var(--nav-height); /* Offset for sticky nav */ }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.8; /* Increased line height */
            overflow-x: hidden;
            font-size: 16.5px; /* Slightly larger base */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container { max-width: 1100px; margin: 0 auto; padding: 0 25px; }

        /* --- Scroll Progress & Back-to-Top --- */
        .scroll-progress { position: fixed; top: 0; left: 0; height: 4px; background: linear-gradient(90deg, var(--accent-yellow), var(--accent-yellow-dark)); width: 0%; z-index: 1003; transition: width 0.1s linear; }
        .back-to-top { position: fixed; bottom: 30px; right: 30px; width: 48px; height: 48px; background-color: var(--accent-yellow-dark); color: #111; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; opacity: 0; visibility: hidden; transition: var(--transition-med); z-index: 1001; box-shadow: 0 5px 10px rgba(0,0,0,0.5); font-size: 1.2rem;}
        .back-to-top.visible { opacity: 0.85; visibility: visible; }
        .back-to-top:hover { opacity: 1; transform: translateY(-4px) scale(1.08); background-color: var(--accent-yellow); box-shadow: 0 8px 15px rgba(0,0,0,0.6); }

        /* --- Navigation --- */
        .navbar {
            position: sticky; top: 0; width: 100%;
            background-color: var(--bg-nav);
            backdrop-filter: blur(var(--nav-blur));
            -webkit-backdrop-filter: blur(var(--nav-blur));
            z-index: 1001;
            border-bottom: 1px solid var(--border-nav);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            height: var(--nav-height); /* Set fixed height */
            display: flex; /* Use flex to vertically center content */
            align-items: center;
        }
        .nav-content {
            display: flex; justify-content: space-between; align-items: center;
            width: 100%; /* Take full width of container */
            max-width: 1280px; margin-left: auto; margin-right: auto;
            padding: 0 1rem; /* No vertical padding needed due to fixed height */
        }
        @media (min-width: 640px) { .nav-content { padding: 0 1.5rem; } }
        @media (min-width: 1024px) { .nav-content { padding: 0 2rem; } }

        .nav-logo { text-decoration: none; display: flex; align-items: center; }
        .nav-logo-img { height: 28px; /* Slightly larger logo */ width: auto; display: block; object-fit: contain; vertical-align: middle; margin-right: 10px; /* Add space between logo and text if any */ }
        .nav-links { display: flex; gap: 2rem; list-style: none; margin: 0; padding: 0; } /* Increased gap */
        .nav-link a {
            color: var(--text-link-default); text-decoration: none;
            font-size: 0.9rem; font-weight: 500;
            transition: color 0.2s ease-in-out;
            padding: 5px 0; /* Vertical padding for hover area */
            border-bottom: 2px solid transparent; position: relative;
        }
        .nav-link a::after { display: none; /* Remove underline effect for cleaner look */ }
        .nav-link a:hover, .nav-link a.active { color: var(--nav-link-hover); }
        .nav-link a.active { font-weight: 700; } /* Make active link bold */

        .mobile-menu-button { display: none; background: none; border: none; color: var(--text-primary); font-size: 1.7rem; cursor: pointer; padding: 5px; line-height: 1; }

        /* --- Header --- */
        header { padding: 7rem 0 6rem; text-align: center; background: linear-gradient(180deg, #111113 0%, #1a1a1c 70%, #111113 100%); border-bottom: 1px solid var(--border-color); position: relative; overflow: hidden; }
        header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.03) 1px, transparent 0); background-size: 30px 30px; opacity: 0.4; z-index: 0;}
        .header-content {position: relative; z-index: 1;}
        .interactive-badge { display: inline-block; background: rgba(253, 224, 71, 0.1); color: var(--accent-yellow); padding: 0.45rem 1.1rem; border-radius: 20px; font-size: 0.9rem; font-weight: 500; border: 1px solid rgba(253, 224, 71, 0.3); margin-bottom: 1.5rem; }
        h1 { font-size: 3.6rem; margin-bottom: 1.2rem; font-weight: 700; line-height: 1.2; background: linear-gradient(90deg, #ffffff, var(--accent-yellow), #ffffff); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; text-fill-color: transparent; animation: shine 6s linear infinite; background-size: 250% auto; }
        @keyframes shine { 0% { background-position: 200% center; } 100% { background-position: -200% center; } }
        header p.subtitle { font-size: 1.25rem; color: var(--text-secondary); max-width: 880px; margin: 0 auto 3rem; }
        .interaction-guide { font-size: 0.95rem; color: var(--text-secondary); margin-top: 2.5rem; display: flex; justify-content: center; gap: 12px 18px; flex-wrap: wrap; }
        .interaction-guide span { background: var(--bg-card); padding: 7px 14px; border-radius: 6px; border: 1px solid var(--border-color); text-align: center; } /* Align text center */
        .interaction-guide i { color: var(--accent-yellow-dark); margin-right: 7px; vertical-align: baseline; width: 1.1em; }
        .authors { margin-top: 4rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 1.2rem 3rem; }
        .author { text-align: center; }
        .author span { display: block; font-weight: 500; font-size: 1rem; }
        .affiliation { font-style: italic; color: var(--text-secondary); font-size: 0.9rem; display: block; margin-top: 5px; }

        /* --- Download Button --- */
        .download-button {
            display: inline-flex; /* Use flex to align icon and text */
            align-items: center;
            gap: 10px; /* Space between icon and text */
            margin-top: 2.5rem; /* Space above the button */
            margin-bottom: 2rem; /* Space below the button */
            padding: 0.8rem 1.6rem; /* Button padding */
            background-color: var(--accent-yellow-dark);
            color: var(--bg-dark); /* Dark text on yellow button */
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            border-radius: 8px;
            border: 1px solid transparent;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: var(--transition-med);
            cursor: pointer;
        }
        .download-button i { font-size: 1.1em; /* Make icon slightly larger */ }
        .download-button:hover,
        .download-button:focus-visible { /* Combined hover/focus styles */
            background-color: var(--accent-yellow);
            color: #111; /* Ensure contrast on lighter yellow */
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4), var(--shadow-glow);
            outline: none; /* Custom focus handled by box-shadow/transform */
        }

        /* --- Main Content --- */
        main { padding: 5rem 0; }
        section { margin-bottom: 6rem; padding-top: calc(var(--nav-height) + 30px); margin-top: calc(-1 * (var(--nav-height) + 30px)); } /* Adjusted offset */
        h2 { font-size: 2.5rem; margin-bottom: 3rem; color: var(--accent-yellow); border-bottom: 1px solid var(--border-color); padding-bottom: 1.1rem; display: inline-block; font-weight: 700;}
        h2 i { margin-right: 18px; opacity: 0.8; vertical-align: middle; font-size: 0.85em; }
        h3 { font-size: 1.8rem; margin: 3rem 0 2rem; color: var(--text-primary); display: flex; align-items: center; gap: 14px; font-weight: 600; }
        h3 i { color: var(--accent-yellow-dark); opacity: 0.7; font-size: 1.6rem; }
        p { margin-bottom: 1.5rem; color: var(--text-primary); font-size: 1.1rem; text-align: left; /* Changed from justify for better mobile readability */ }
        strong { color: var(--accent-yellow-dark); font-weight: 600; }
        code { background-color: rgba(253, 224, 71, 0.1); color: var(--accent-yellow); padding: 0.3em 0.6em; border-radius: 6px; font-size: 0.9em; font-family: 'SF Mono', Consolas, monospace; border: 1px solid rgba(253, 224, 71, 0.15); }
        ul, ol { margin-left: 30px; margin-bottom: 1.5rem; color: var(--text-primary); font-size: 1.1rem; }
        li { margin-bottom: 0.8rem; padding-left: 8px; }
        ::marker { color: var(--accent-yellow); font-size: 0.9em; }
        hr.section-divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, var(--border-color), transparent); margin: 5rem auto; opacity: 0.5; }

        /* --- Cards --- */
        .card { background: var(--bg-card-subtle-gradient); border-radius: 12px; padding: 2.2rem 2.8rem; margin-bottom: 2.2rem; border: 1px solid var(--border-color); box-shadow: var(--shadow-card); transition: var(--transition-med); }
        .card:hover { transform: translateY(-8px) scale(1.01); box-shadow: var(--shadow-card-hover), var(--shadow-glow); border-color: rgba(250, 204, 21, 0.4); } /* Nicer hover border */
        .abstract-card { border-left: 6px solid var(--accent-yellow); } /* Brighter border */
        .highlight-box { background: linear-gradient(145deg, rgba(96, 165, 250, 0.08), rgba(96, 165, 250, 0.15)); border-left: 6px solid var(--accent-blue); padding: 2.2rem; margin: 3rem 0; border-radius: 0 12px 12px 0; }
        .highlight-box strong { color: var(--accent-blue); }
        .highlight-box ul { margin-bottom: 0.6rem; }
        .highlight-box i { transition: color 0.2s ease; }

        /* --- Grid Layouts --- */
        .grid-container { display: grid; gap: 2.2rem; } /* Increased gap */
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }

        /* --- Figures & Tables --- */
        figure { margin: 3rem 0; text-align: center; transition: var(--transition-med); }
        figure img { max-width: 100%; height: auto; border-radius: 12px; background-color: #f5f5f5; padding: 8px; border: 1px solid var(--border-color); cursor: pointer; transition: var(--transition-med); display: block; margin: 0 auto; box-shadow: 0 6px 12px rgba(0,0,0,0.3); }
        figure img:hover { transform: scale(1.05); box-shadow: 0 12px 25px rgba(0,0,0,0.5), var(--shadow-glow); border-color: var(--accent-yellow); }
        figcaption { margin-top: 1.3rem; font-size: 1rem; color: var(--text-secondary); font-style: italic; }
        .table-container { overflow-x: auto; margin: 3rem 0; border: 1px solid var(--border-color); border-radius: 12px; background-color: var(--bg-card); box-shadow: inset 0 3px 6px rgba(0,0,0,0.4); -webkit-overflow-scrolling: touch; /* Improve scrolling on iOS */ }
        table { width: 100%; border-collapse: collapse; min-width: 600px; /* Suggest a min-width to ensure readability before scrolling kicks in */ }
        th, td { padding: 1.1rem 1.4rem; text-align: left; border-bottom: 1px solid var(--border-color); font-size: 1rem; vertical-align: middle; }
        th { background-color: rgba(253, 224, 71, 0.08); color: var(--accent-yellow); font-weight: 600; white-space: nowrap; }
        tr:last-child td { border-bottom: none; }
        tbody tr { transition: background-color 0.15s ease-in-out; }
        tbody tr:hover { background-color: rgba(255, 255, 255, 0.06); }

        /* --- Tooltips --- */
        .tooltip-trigger {
            border-bottom: 1px dotted var(--accent-yellow);
            cursor: help;
            position: relative; /* Needed for absolute positioning of tooltip */
        }
        .tooltip {
            position: absolute; bottom: 135%; left: 50%;
            background-color: #38383a; color: var(--text-primary);
            padding: 0.7rem 1.1rem; border-radius: 8px; font-size: 0.9rem;
            white-space: nowrap; z-index: 101;
            opacity: 0; visibility: hidden; pointer-events: none;
            transition: opacity 0.25s ease, visibility 0.25s ease, transform 0.25s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.6);
            transform: translateX(-50%) translateY(8px); /* Start slightly lower */
            transform-origin: bottom center;
            width: max-content; /* Ensure it doesn't wrap unnecessarily */
            max-width: 250px; /* Prevent very wide tooltips */
        }
        .tooltip::after { /* Arrow */
            content: ''; position: absolute; top: 100%; left: 50%; margin-left: -6px;
            border-width: 6px; border-style: solid; border-color: #38383a transparent transparent transparent;
        }
        .tooltip-trigger:hover .tooltip,
        .tooltip-trigger:focus .tooltip, /* Show on focus too */
        .tooltip.visible-focus { /* Class added by JS for focus */
            opacity: 1; visibility: visible; transform: translateX(-50%) translateY(-8px); /* Move up slightly */
        }


        /* --- Accordion --- */
        .accordion-item {
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 1.5rem;
            background-color: var(--bg-card);
            overflow: hidden;
            transition: box-shadow 0.3s ease, border-color 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .accordion-item:hover {
            border-color: rgba(253, 224, 71, 0.6); /* Slightly stronger hover border */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .accordion-header { position: relative; }
        .accordion-button {
            background-color: transparent; /* Let item background show */
            padding: 1.3rem 2rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
            user-select: none;
            width: 100%;
            text-align: left;
            border: none; color: inherit; font: inherit;
            border-radius: 0;
        }
        .accordion-button:hover { background-color: rgba(255, 255, 255, 0.04); }
        .accordion-button:focus { outline: none; } /* Use focus-visible */
        .accordion-button h4 { margin: 0; font-size: 1.25rem; font-weight: 600; color: var(--text-primary); transition: color 0.3s ease; pointer-events: none; display: flex; align-items: center; gap: 10px; /* Gap between icon and text */ }
        .accordion-button h4 small { font-size: 0.8em; font-weight: 400; color: var(--text-secondary); opacity: 0.8; } /* Style the small tag */
        .accordion-button:hover h4 { color: var(--accent-yellow); }
        .accordion-icon { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); color: var(--accent-yellow); font-size: 1.125rem; opacity: 0.9; margin-left: 1rem; flex-shrink: 0; pointer-events: none; }
        .accordion-button[aria-expanded="true"] .accordion-icon { transform: rotate(180deg); }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0, 1, 0, 1),
                        padding 0.4s ease,
                        opacity 0.4s ease;
            padding: 0 2rem; opacity: 0;
            border-top: 1px solid transparent; /* Prepare for divider effect */
        }
        .accordion-content.active {
            max-height: 1500px; /* Generous max height */
            padding: 1.5rem 2rem 2rem; opacity: 1;
            transition: max-height 1s ease-in-out,
                        padding 0.4s ease,
                        opacity 0.6s ease,
                        border-color 0.3s ease 0.2s; /* Delay border appearance */
            border-top-color: rgba(253, 224, 71, 0.3);
        }
        .accordion-content p { line-height: 1.7; margin-bottom: 1rem; }
        .accordion-content p:last-child { margin-bottom: 0; }


        /* --- Counters --- */
        .counter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.8rem; margin: 3.5rem 0;
        }
        .counter-card {
            background: var(--bg-card-subtle-gradient); border-radius: 12px;
            border: 1px solid var(--border-color); transition: var(--transition-med);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; min-height: 160px; padding: 1.5rem 1rem;
        }
        .counter-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-glow), 0 10px 20px rgba(0,0,0,0.45);
            border-color: var(--accent-yellow-dark);
        }
        .counter-value {
            font-size: 2.8rem; font-weight: 700; color: var(--accent-yellow);
            margin-bottom: 0.5rem; line-height: 1.1;
        }
        .counter-title { font-size: 0.95rem; color: var(--text-secondary); margin-top: 0.2rem; }

        /* --- Metrics & Charts --- */
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.3rem; margin: 2rem 0; }
        .metric-card { background-color: var(--bg-card); padding: 1.4rem; border-radius: 10px; text-align: center; border: 1px solid var(--border-color); }
        .metric-name { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.6rem; text-transform: uppercase; font-weight: 500; letter-spacing: 0.5px; }
        .metric-value { font-size: 2rem; font-weight: 700; color: var(--accent-yellow-dark); line-height: 1.1; }
        .chart-container { position: relative; min-height: 320px; width: 100%; margin: 3rem 0; background-color: rgba(255, 255, 255, 0.02); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border-color); box-shadow: inset 0 3px 6px rgba(0,0,0,0.25); }

        /* --- References --- */
        #references ol { list-style: none; padding-left: 0; counter-reset: ref-counter; }
        #references li { counter-increment: ref-counter; margin-bottom: 1.1rem; padding-left: 40px; position: relative; font-size: 1rem; line-height: 1.65; }
        #references li::before { content: "[" counter(ref-counter) "]"; position: absolute; left: 0; top: 0; color: var(--accent-yellow); font-weight: 600; } /* Brighter number */
        #references a { color: var(--accent-blue); text-decoration: none; border-bottom: 1px dotted var(--accent-blue); transition: var(--transition-fast); word-break: break-word; } /* Allow break */
        #references a:hover { color: #93c5fd; border-bottom-style: solid; }

        /* --- Footer --- */
        footer { background-color: #0c0c0c; color: var(--text-secondary); padding: 4.5rem 0 3.5rem; margin-top: 7rem; border-top: 1px solid var(--border-color); }
        .footer-content { text-align: center; font-size: 1rem; }
        .footer-logo { font-size: 1.5rem; font-weight: 700; color: var(--accent-yellow); margin-bottom: 1.8rem; display: inline-block; text-decoration: none; }
        .footer-logo i { margin-right: 12px; }

        /* --- Modal --- */
        .modal {
            display: none; position: fixed; z-index: 1003; left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            align-items: center; justify-content: center; padding: 25px;
            opacity: 0; transition: opacity 0.3s ease-out;
        }
        .modal.visible { display: flex; opacity: 1; } /* Use flex here */
        .modal-image-wrapper {
             display: flex; justify-content: center; align-items: center;
             width: 100%; height: 100%;
        }
        .modal-content { /* This is the IMG */
            margin: auto; display: block;
            max-width: 94%; max-height: 90vh;
            background-color: var(--bg-card); padding: 5px; /* Minimal padding around image */
            border-radius: 8px; border: 1px solid var(--border-color);
            animation: modalZoomIn 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            object-fit: contain;
        }
        .modal-caption { margin: 20px auto 10px; display: block; max-width: 88%; text-align: center; color: #d0d0d0; font-size: 1.1rem; }
        .modal-close { position: absolute; top: 20px; right: 35px; color: #f5f5f5; font-size: 55px; font-weight: bold; transition: 0.3s; cursor: pointer; line-height: 0.7; text-shadow: 0 2px 4px rgba(0,0,0,0.6); background: none; border: none; padding: 0; }
        .modal-close:hover, .modal-close:focus { color: var(--accent-yellow); }
         @keyframes modalZoomIn {
             from { transform: scale(0.8) translateY(20px); opacity: 0; }
             to { transform: scale(1) translateY(0); opacity: 1; }
         }

        /* --- Scroll Animations --- */
        [data-animate] { opacity: 0; transform: translateY(50px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        [data-animate].visible { opacity: 1; transform: translateY(0); }

        /* --- Utility --- */
        .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }
        ::selection { background-color: var(--accent-yellow-dark); color: var(--bg-dark); }

        /* --- Accessibility & Polish --- */
        @media (prefers-reduced-motion: reduce) {
          *, *::before, *::after {
            animation-duration: 0.01ms !important; animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important; scroll-behavior: auto !important;
          }
          h1 { animation: none !important; }
          .counter-value { transition: none !important; }
          .chart-container canvas { animation: none !important; }
          [data-animate] { transition: none !important; transform: none !important; opacity: 1 !important; }
        }

         /* Improved Focus Styles */
         :focus-visible {
             outline: 3px solid var(--focus-outline-color); outline-offset: 2px;
             border-radius: 4px; box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.3);
         }
         .nav-link a:focus-visible,
         .mobile-menu-button:focus-visible,
         .back-to-top:focus-visible,
         .download-button:focus-visible,
         figure img:focus-visible,
         .tooltip-trigger:focus-visible {
              outline: 2px dotted var(--accent-yellow); outline-offset: 3px;
              box-shadow: none; border-radius: 2px;
         }
         /* Remove default outline specifically from figure img if using tabindex */
         figure img:focus { outline: none; }
         figure img:focus-visible { /* Already defined above, keeps the dotted yellow */ }

        .accordion-button:focus-visible {
             outline: none; background-color: rgba(255, 255, 255, 0.1);
             box-shadow: inset 0 0 0 2px var(--focus-outline-color);
        }
        .modal-close:focus-visible {
            outline: 3px solid var(--accent-yellow-dark); outline-offset: 2px;
            box-shadow: none; border-radius: 50%; background-color: rgba(255, 255, 255, 0.1);
         }


        /* --- ================================= --- */
        /* --- MOBILE RESPONSIVE REFINEMENTS --- */
        /* --- ================================= --- */

        /* --- Tablet Landscape / Small Laptops (992px) --- */
        @media (max-width: 992px) {
            .grid-cols-3 { grid-template-columns: repeat(2, 1fr); } /* 3 columns -> 2 columns */
            h1 { font-size: 3rem; }
            h2 { font-size: 2.2rem; }
            h3 { font-size: 1.7rem; }
        }

        /* --- Tablet Portrait / Large Mobile (768px) --- */
        @media (max-width: 768px) {
            body { font-size: 16px; line-height: 1.7; } /* Reset base size */
            .container { padding: 0 20px; }

            /* --- Mobile Navigation --- */
            .mobile-menu-button { display: block; } /* Show hamburger */
            .nav-links {
               display: none; /* Hidden by default */
               position: absolute; top: 100%; /* Position below navbar */ left: 0; width: 100%;
               background-color: var(--bg-card); /* Use card bg */
               flex-direction: column; /* Stack vertically */
               padding: 1rem 0; border-top: 1px solid var(--border-color);
               box-shadow: 0 10px 25px rgba(0,0,0,0.6); /* Stronger shadow */
               max-height: 0; overflow-y: auto; /* Allow scroll if needed */
               transition: max-height 0.4s ease-out, opacity 0.3s ease-out; /* Add opacity transition */
               gap: 0; /* Remove desktop gap */
               opacity: 0; /* Start hidden for fade */
               visibility: hidden;
            }
            .nav-links.mobile-nav-open {
                display: flex; /* Use flex when open */
                max-height: calc(100vh - var(--nav-height)); /* Full height minus nav */
                opacity: 1;
                visibility: visible;
            }
            .nav-link { width: 100%; text-align: left; border-bottom: 1px solid var(--border-color); }
            .nav-link:last-child { border-bottom: none; }
            .nav-link a {
                display: block; /* Make link fill width */
                padding: 1rem 1.5rem; /* Generous padding for touch */
                font-size: 1rem; color: var(--text-primary);
                border-bottom: none; /* Remove desktop border */
            }
            .nav-link a:hover, .nav-link a.active {
                background-color: rgba(255, 255, 255, 0.05); color: var(--nav-link-hover);
            }

             /* --- Layout & Content Adjustments --- */
            .grid-cols-2, .grid-cols-3 { grid-template-columns: 1fr; } /* All grids stack to single column */
            header { padding: 5.5rem 0 4.5rem; }
            h1 { font-size: 2.8rem; }
            .authors { gap: 1rem 2rem; }
            .download-button { margin-top: 2rem; margin-bottom: 1.5rem; font-size: 0.95rem; padding: 0.7rem 1.4rem; } /* Adjust button */
            section { margin-bottom: 5rem; }
            .card { padding: 1.8rem 2rem; }
            .highlight-box { padding: 1.8rem; }
            th, td { padding: 1rem 1.1rem; font-size: 0.95rem; white-space: normal; /* Allow wrapping in table cells */ }
            th { white-space: nowrap; /* Keep headers nowrap if needed, rely on scroll */ }
            .counter-grid { gap: 1.8rem; }
            .counter-value { font-size: 2.8rem; }
            .metrics-grid { gap: 1.1rem; }
            .metric-value { font-size: 1.8rem; }
            #references li { font-size: 0.95rem; padding-left: 35px; }
            #references li::before { font-size: 0.95rem; }
            .back-to-top { width: 44px; height: 44px; font-size: 1.1rem; bottom: 25px; right: 25px; }
            .modal-content { max-width: 95%; padding: 15px; }
            .modal-close { top: 18px; right: 25px; font-size: 45px; }

             /* --- Accordion Mobile --- */
             .accordion-button { padding: 1rem 1.5rem; }
             .accordion-button h4 { font-size: 1.125rem; }
             .accordion-button h4 small { display: block; font-size: 0.75em; margin-top: 2px; } /* Stack the small text */
             .accordion-content.active { padding: 1.25rem 1.5rem 1.5rem; }
        }

        /* --- Small Mobile (480px) --- */
        @media (max-width: 480px) {
            /* Adjust nav height and scroll padding if needed, otherwise keep 65px */
            /* html { scroll-padding-top: 60px; } */
            /* .navbar { height: 60px; } */

            body { font-size: 15.5px; }
            .container { padding: 0 15px; } /* Less horizontal padding */

            /* --- Typography --- */
            h1 { font-size: 2.4rem; line-height: 1.3; }
            h2 { font-size: 2rem; }
            h3 { font-size: 1.6rem; }
            header p.subtitle { font-size: 1.1rem; /* Slightly smaller */ }
            p, li, figcaption { font-size: 1rem; /* Adjust base paragraph/list size */ }
             ul, ol { margin-left: 20px; } /* Reduce list indent */

            /* --- Layout & Elements --- */
             .card { padding: 1.5rem 1.2rem; /* Reduce card padding further */ }
             .download-button {
                 width: 90%; /* Make button wider */
                 margin-left: auto; margin-right: auto; /* Center block element */
                 justify-content: center; /* Center flex content */
                 display: flex; /* Ensure flex is still applied */
                 padding: 0.75rem 1rem; /* Adjust padding slightly */
                 font-size: 0.9rem;
             }
             .counter-grid {
                 grid-template-columns: 1fr 1fr; /* Force 2 columns */
                 gap: 1.2rem; margin: 3rem 0;
             }
             .counter-value { font-size: 2.5rem; }
             .counter-title { font-size: 0.9rem; } /* Slightly smaller */
             .metrics-grid {
                 grid-template-columns: 1fr 1fr; /* Force 2 columns */
                 gap: 1rem;
             }
             .metric-value { font-size: 1.7rem; }
             th, td { padding: 0.8rem 0.9rem; font-size: 0.9rem; /* Smaller table text/padding */ }
             figure { margin: 2rem 0; }
             figcaption { font-size: 0.9rem; }
             #references li { font-size: 0.9rem; line-height: 1.6; }

             .interaction-guide { font-size: 0.85rem; gap: 8px 12px; }
             .interaction-guide span { padding: 6px 10px; }
        }

    </style>
</head>
<body>
    <div class="scroll-progress"></div>
    <a href="#" class="back-to-top" aria-label="Scroll back to top"><i class="fas fa-arrow-up" aria-hidden="true"></i></a>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="container nav-content">
            <a href="#" class="nav-logo" title="GridGenius Homepage">
                <!-- Make sure path is correct -->
                <img src="assets/logo.png" alt="GridGenius Logo" class="nav-logo-img">
                 <span class="sr-only">GridGenius</span>
            </a>
            <button class="mobile-menu-button" id="mobile-menu-toggle" aria-label="Toggle Menu" aria-expanded="false" aria-controls="nav-links-list">
                <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
            <ul class="nav-links" id="nav-links-list">
                <li class="nav-link"><a href="#abstract" class="active">Abstract</a></li>
                <li class="nav-link"><a href="#introduction">Introduction</a></li>
                <li class="nav-link"><a href="#related-work">Related Work</a></li>
                <li class="nav-link"><a href="#methodology">Methodology</a></li>
                <li class="nav-link"><a href="#results">Results</a></li>
                <li class="nav-link"><a href="#conclusion">Conclusion</a></li>
                <li class="nav-link"><a href="#references">References</a></li>
            </ul>
        </div>
    </nav>

    <header>
        <div class="container header-content">
            <div class="interactive-badge">Interactive Research Paper</div>
            <h1>GridGenius</h1>
            <p class="subtitle" data-animate>Hybrid Machine Learning and Transformer-Based Explainable Energy Demand Forecasting for Bangladesh</p>
            <div class="authors" data-animate>
                 <div class="author"><span>Adib Ar Rahman Khan</span><span class="affiliation">North South University</span></div>
                 <div class="author"><span>Md Aurongojeb Lishad</span><span class="affiliation">North South University</span></div>
                 <div class="author"><span>Pranoy Saha</span><span class="affiliation">North South University</span></div>
                 <div class="author"><span>Sadia Islam Mou</span><span class="affiliation">North South University</span></div>
            </div>

            <!-- === DOWNLOAD BUTTON === -->
            <a href="assets/GridGenius - AAR Khan, A Lishad, P Saha, SI Mou.pdf" class="download-button" target="_blank" rel="noopener noreferrer" data-animate>
                <i class="fas fa-file-pdf" aria-hidden="true"></i>
                <span>Download PDF</span>
            </a>
            <!-- === END DOWNLOAD BUTTON === -->

            <div class="interaction-guide" data-animate>
                 <span><i class="fas fa-hand-pointer" aria-hidden="true"></i> Click Figures</span>
                 <span><i class="fas fa-info-circle" aria-hidden="true"></i> Hover <span class="tooltip-trigger" aria-describedby="tooltip-term-example"><u>Terms</u><span class="tooltip" role="tooltip" id="tooltip-term-example">Like this one! Definitions appear on hover or focus.</span></span></span>
                 <span><i class="fas fa-chevron-down" aria-hidden="true"></i> Expand Sections</span>
                 <span><i class="fas fa-laptop" aria-hidden="true"></i> Best on Desktop</span>
            </div>
        </div>
    </header>

    <main class="container">

        <!-- Abstract Section -->
        <section id="abstract">
             <h2 data-animate><i class="fas fa-file-alt" aria-hidden="true"></i>Abstract</h2>
             <div class="card abstract-card" data-animate>
                <p>Bangladesh faces critical challenges in balancing electricity generation with demand, leading to resource wastage, high costs, and load shedding. We present <strong>GridGenius</strong>, a novel, fully deployed <span class="tooltip-trigger" aria-describedby="tooltip-ai">AI<span class="tooltip" role="tooltip" id="tooltip-ai">Artificial Intelligence</span></span>-powered platform for accurate and explainable daily electricity demand forecasting.</p>
                <p>The system uses a <strong>hybrid model</strong> integrating classical <span class="tooltip-trigger" aria-describedby="tooltip-ml">ML<span class="tooltip" role="tooltip" id="tooltip-ml">Machine Learning</span></span> (Random Forest, XGBoost) with a custom <strong>Transformer</strong> regressor, achieving <span class="tooltip-trigger" aria-describedby="tooltip-r2">R²<span class="tooltip" role="tooltip" id="tooltip-r2">Coefficient of Determination: How well predictions replicate real data points (0-1 scale).</span></span> scores up to <strong>0.89</strong>. A unique dataset from 1,800+ daily <span class="tooltip-trigger" aria-describedby="tooltip-bpdb-1">BPDB<span class="tooltip" role="tooltip" id="tooltip-bpdb-1">Bangladesh Power Development Board</span></span> reports (2020-2024) was created, enriched with holiday, temperature, and seasonal data.</p>
                <p>GridGenius incorporates a <span class="tooltip-trigger" aria-describedby="tooltip-rag-1">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-1">Retrieval-Augmented Generation: Enhances LLM answers with external knowledge.</span></span> pipeline with a <span class="tooltip-trigger" aria-describedby="tooltip-llm-1">LLM<span class="tooltip" role="tooltip" id="tooltip-llm-1">Large Language Model (e.g., Llama 3)</span></span> for transparency, allowing natural language queries about forecasts. Deployed as a web app, it offers a scalable, transparent solution for smarter grid management.</p>
             </div>
        </section>

         <hr class="section-divider">

        <!-- Introduction Section -->
        <section id="introduction">
            <h2 data-animate><i class="fas fa-lightbulb" aria-hidden="true"></i>Introduction</h2>
            <p data-animate>Bangladesh's energy sector is marked by a persistent struggle to align electricity generation with national demand. This imbalance results in frequent load shedding, inefficient resource use, and significant economic consequences. Despite generation capacity growth, the <span class="tooltip-trigger" aria-describedby="tooltip-bpdb-2">BPDB<span class="tooltip" role="tooltip" id="tooltip-bpdb-2">Bangladesh Power Development Board</span></span> [1] still grapples with demand-supply mismatches, especially during peak periods and seasonal transitions. A key bottleneck is the lack of dynamic, interpretable, and real-time forecasting systems [3] to guide grid optimization efforts.</p>
            <p data-animate>Traditional forecasting approaches, including statistical models (<span class="tooltip-trigger" aria-describedby="tooltip-arima">ARIMA<span class="tooltip" role="tooltip" id="tooltip-arima">Autoregressive Integrated Moving Average</span></span>) and basic <span class="tooltip-trigger" aria-describedby="tooltip-ml-2">ML<span class="tooltip" role="tooltip" id="tooltip-ml-2">Machine Learning</span></span> techniques, often fall short. They may struggle to generalize across time scales, ignore crucial external factors like holidays or weather patterns, and lack the scalability needed for daily operational deployment. This highlights the need for an intelligent, adaptable system providing accurate daily forecasts coupled with clear, understandable explanations.</p>
             <div class="card" data-animate>
                <h3><i class="fas fa-star" aria-hidden="true"></i>Our Contribution: GridGenius</h3>
                <p>GridGenius is designed to fill this gap by integrating novel, state-of-the-art AI techniques:</p>
                <ul>
                    <li>A <strong>Hybrid Modeling Strategy:</strong> Combines established ML algorithms (Random Forest, XGBoost) with a custom Transformer architecture [2].</li>
                    <li><strong>Novel & Enriched Dataset:</strong> A comprehensive daily record (2020-2024) from BPDB reports [1], enhanced with temperature, holidays, and engineered features.</li>
                    <li><strong>Explainable AI (<span class="tooltip-trigger" aria-describedby="tooltip-xai-1">XAI<span class="tooltip" role="tooltip" id="tooltip-xai-1">Explainable Artificial Intelligence</span></span>) Core [3]:</strong> Utilizes a <span class="tooltip-trigger" aria-describedby="tooltip-rag-2">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-2">Retrieval-Augmented Generation</span></span> [4] pipeline with Llama 3.1 [14] for transparent, natural language interaction.</li>
                    <li><strong>Full Deployment:</strong> An novel interactive web application providing forecasts, visualizations, and conversational insights.</li>
                </ul>
            </div>
            <div class="counter-grid" data-animate>
                 <div class="counter-card">
                     <div class="counter-value" data-target="1800">0</div>
                     <div class="counter-title">BPDB Reports Processed</div>
                 </div>
                 <div class="counter-card">
                    <!-- Adjusted height for chart container within counter card -->
                    <div class="chart-container" style="height: 100px; min-height: 100px; width: 100%; margin: 0 auto 0.5rem; padding: 5px; box-shadow: none; background: none; border: none;">
                         <canvas id="r2ScoreChart" role="img" aria-label="Doughnut chart showing R² Score Achieved: 89%"></canvas>
                     </div>
                     <div class="counter-title">Peak R² Score Achieved</div>
                 </div>
                 <div class="counter-card">
                     <div class="counter-value" data-target="4">4</div>
                     <div class="counter-title">Years of Data Analyzed</div>
                 </div>
            </div>
        </section>

        <hr class="section-divider">

        <!-- Related Work Section -->
        <section id="related-work">
            <h2 data-animate><i class="fas fa-book-open" aria-hidden="true"></i>Related Work & Research Gaps</h2>
             <p data-animate>Energy demand forecasting has evolved, but gaps remain. We reviewed relevant studies to position GridGenius:</p>

             <div class="accordion-item" data-animate>
                 <div class="accordion-header" id="accordion-header-1">
                    <button class="accordion-button" aria-expanded="false" aria-controls="accordion-content-1">
                        <h4><i class="fas fa-tasks" aria-hidden="true"></i>Review of Existing Approaches<small>(Click to Expand)</small></h4>
                        <i class="fas fa-chevron-down accordion-icon" aria-hidden="true"></i>
                    </button>
                 </div>
                 <div class="accordion-content" id="accordion-content-1" role="region" aria-labelledby="accordion-header-1">
                    <ul>
                        <li><strong>Classical ML:</strong> Hossain [5] used XGBoost on partial <span class="tooltip-trigger" aria-describedby="tooltip-bpdb-3">BPDB<span class="tooltip" role="tooltip" id="tooltip-bpdb-3">Bangladesh Power Development Board</span></span> data, lacking features/explainability. Haque [7] applied LightGBM to limited apartment data. Wang [6] explored <span class="tooltip-trigger" aria-describedby="tooltip-cnn">CNN<span class="tooltip" role="tooltip" id="tooltip-cnn">Convolutional Neural Network</span></span>-<span class="tooltip-trigger" aria-describedby="tooltip-lstm">LSTM<span class="tooltip" role="tooltip" id="tooltip-lstm">Long Short-Term Memory network</span></span> but ignored external factors. Haque [8] used <span class="tooltip-trigger" aria-describedby="tooltip-knn">KNN<span class="tooltip" role="tooltip" id="tooltip-knn">K-Nearest Neighbors algorithm</span></span>, facing overfitting and lack of daily detail.</li>
                        <li><strong>Transformers:</strong> While powerful [2, 9] (e.g., Autoformer [10]), their application to operational energy forecasting with specific regional data is sparse.</li>
                        <li><strong>Explainability (<span class="tooltip-trigger" aria-describedby="tooltip-xai-2">XAI<span class="tooltip" role="tooltip" id="tooltip-xai-2">Explainable Artificial Intelligence</span></span>):</strong> Often limited to metrics. <span class="tooltip-trigger" aria-describedby="tooltip-llm-2">LLM<span class="tooltip" role="tooltip" id="tooltip-llm-2">Large Language Model</span></span>-powered <span class="tooltip-trigger" aria-describedby="tooltip-rag-3">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-3">Retrieval-Augmented Generation</span></span> [4, 11] is emerging but not widely adopted in this domain.</li>
                    </ul>
                     <div class="table-container">
                         <table>
                             <caption>Table I: Summary of Related Work (Key Limitations)</caption>
                              <thead><tr><th>Paper</th><th>Approach</th><th>Limitations Noted</th></tr></thead>
                              <tbody>
                                  <tr><td>Hossain [5]</td><td>XGBoost</td><td>Limited features, no explainability</td></tr>
                                  <tr><td>Haque [7]</td><td>LightGBM</td><td>Small dataset, not generalized, lacks external factors</td></tr>
                                  <tr><td>Wang [6]</td><td>CNN-LSTM</td><td>Ignored seasonality & external features</td></tr>
                                  <tr><td>Haque [8]</td><td>KNN</td><td>Lacked daily granularity, overfitting</td></tr>
                                  <tr><td>Wen [9]</td><td>Transformer Survey</td><td>No real-world energy system applications</td></tr>
                                  <tr><td>Wu [10]</td><td>Autoformer</td><td>Tested on synthetic/benchmark data only</td></tr>
                              </tbody>
                         </table>
                     </div>
                 </div>
             </div>

             <div class="highlight-box" data-animate>
                 <strong>Key Research Gaps Addressed by GridGenius:</strong>
                  <ul>
                      <li><i class="fas fa-check-circle" style="color: var(--accent-yellow-dark);" aria-hidden="true"></i> Created comprehensive, multi-year, daily <span class="tooltip-trigger" aria-describedby="tooltip-bpdb-4">BPDB<span class="tooltip" role="tooltip" id="tooltip-bpdb-4">Bangladesh Power Development Board</span></span> dataset.</li>
                      <li><i class="fas fa-check-circle" style="color: var(--accent-yellow-dark);" aria-hidden="true"></i> Implemented robust feature engineering (holidays, temp, season, gap).</li>
                      <li><i class="fas fa-check-circle" style="color: var(--accent-yellow-dark);" aria-hidden="true"></i> Developed and tested hybrid ML/Transformer models tailored for this task.</li>
                      <li><i class="fas fa-check-circle" style="color: var(--accent-yellow-dark);" aria-hidden="true"></i> Integrated interactive <span class="tooltip-trigger" aria-describedby="tooltip-xai-3">XAI<span class="tooltip" role="tooltip" id="tooltip-xai-3">Explainable Artificial Intelligence</span></span> via <span class="tooltip-trigger" aria-describedby="tooltip-rag-4">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-4">Retrieval-Augmented Generation</span></span> pipeline.</li>
                      <li><i class="fas fa-check-circle" style="color: var(--accent-yellow-dark);" aria-hidden="true"></i> Deployed a full-stack, user-friendly system.</li>
                  </ul>
             </div>
        </section>

         <hr class="section-divider">

        <!-- Methodology Section -->
        <section id="methodology">
             <h2 data-animate><i class="fas fa-cogs" aria-hidden="true"></i>Methodology</h2>
             <p data-animate>GridGenius follows a systematic pipeline:</p>
             <ol data-animate>
                 <li>Data Collection & Preprocessing</li>
                 <li>Exploratory Data Analysis (EDA)</li>
                 <li>Feature Engineering</li>
                 <li>Model Development & Training (Hybrid Approach)</li>
                 <li>Explainability (RAG-LLM Integration)</li>
                 <li>System Deployment</li>
             </ol>

             <figure id="fig1" data-animate>
                  <!-- Ensure path is correct -->
                  <img src="assets/fig1_architecture.png" alt="Figure 1: GridGenius System Architecture Overview." onclick="openModal(this)" tabindex="0">
                  <figcaption>Figure 1: GridGenius System Architecture Overview. (Click to Enlarge)</figcaption>
              </figure>

              <div class="card" data-animate>
                <h3><i class="fas fa-database" aria-hidden="true"></i>A. Dataset Collection & Description</h3>
                 <p>Unique dataset scraped from <strong>1,800+ daily <span class="tooltip-trigger" aria-describedby="tooltip-bpdb-5">BPDB<span class="tooltip" role="tooltip" id="tooltip-bpdb-5">Bangladesh Power Development Board</span></span> reports</strong> (Jan 2020 - Mid 2024). Includes Max Demand (MW), Max Generation (MW), Date, enriched with Daily Avg Temp (°C) & National Holiday flag.</p>
             </div>

              <div class="card" data-animate>
                 <h3><i class="fas fa-chart-bar" aria-hidden="true"></i>B. Exploratory Data Analysis (EDA)</h3>
                 <p><span class="tooltip-trigger" aria-describedby="tooltip-eda">EDA<span class="tooltip" role="tooltip" id="tooltip-eda">Exploratory Data Analysis</span></span> revealed key patterns:</p>
                 <div class="grid-container grid-cols-2"> <!-- This will become 1 column on mobile -->
                    <!-- Ensure paths are correct -->
                    <figure id="fig2"><img src="assets/fig2_temp_dist.png" alt="Figure 2: Temperature Distribution histogram showing a peak frequency around 30°C" onclick="openModal(this)" tabindex="0"><figcaption>Fig 2: Temp. Peak ~30°C</figcaption></figure>
                    <figure id="fig3"><img src="assets/fig3_demand_dist.png" alt="Figure 3: Demand Distribution histogram showing a broad spread, slightly skewed right" onclick="openModal(this)" tabindex="0"><figcaption>Fig 3: Broad Demand Spread</figcaption></figure>
                    <figure id="fig6"><img src="assets/fig6_temp_demand.png" alt="Figure 6: Scatter plot showing Demand (Y-axis) generally increasing with Temperature (X-axis), especially above 25°C" onclick="openModal(this)" tabindex="0"><figcaption>Fig 6: Demand Rises with Temp</figcaption></figure>
                    <figure id="fig7"><img src="assets/fig7_holiday_demand.png" alt="Figure 7: Box plot comparing Demand on Holidays vs Non-Holidays, showing significantly lower median and range on holidays" onclick="openModal(this)" tabindex="0"><figcaption>Fig 7: Lower Demand on Holidays</figcaption></figure>
                </div>
             </div>

             <div class="card" data-animate>
                 <h3><i class="fas fa-tools" aria-hidden="true"></i>C. Feature Engineering & Data Iterations</h3>
                  <p>Features engineered: Demand-Gen Gap, Season Classification, Holiday Flag. Preprocessing: Outlier handling (<span class="tooltip-trigger" aria-describedby="tooltip-iqr-1">IQR<span class="tooltip" role="tooltip" id="tooltip-iqr-1">Interquartile Range</span></span>, Z-score), Scaling (MinMaxScaler, StandardScaler). Four dataset variants created for robustness testing.</p>
             </div>

             <div class="card" data-animate>
                 <h3><i class="fas fa-robot" aria-hidden="true"></i>D. Modeling Pipeline</h3>
                 <p>Models explored: Linear Regression, <strong>Random Forest</strong> (Top Classical), <strong>XGBoost</strong>, SVR, <strong>Transformer</strong> (Custom DL). Tuned RF/XGBoost via <code>RandomizedSearchCV</code>.</p>
             </div>

              <div class="card" data-animate>
                 <h3><i class="fas fa-microchip" aria-hidden="true"></i>E. Primary Model: Transformer Regressor</h3>
                 <p>Custom Transformer [2] with multi-head self-attention, feed-forward layers, positional encoding, dropout. Trained with Adam [12] optimizer & <span class="tooltip-trigger" aria-describedby="tooltip-mse-1">MSE<span class="tooltip" role="tooltip" id="tooltip-mse-1">Mean Squared Error</span></span> loss.</p>
                  <div class="table-container">
                      <table>
                          <caption>Table II: Transformer Implementation Details (Selected)</caption>
                           <thead><tr><th>Parameter</th><th>Value</th></tr></thead>
                           <tbody>
                               <tr><td>Optimizer</td><td>Adam [12]</td></tr>
                               <tr><td>Loss Function</td><td>MSE</td></tr>
                               <tr><td>Training Epochs</td><td>50</td></tr>
                               <tr><td>Key Hyperparameters Tuned</td><td>num_heads, model_dim, num_layers, dropout, learning_rate</td></tr>
                           </tbody>
                      </table>
                  </div>
             </div>

             <div class="card" data-animate>
                <h3><i class="fas fa-comments" aria-hidden="true"></i>F. Explainability via RAG-LLM</h3>
                 <p>Achieved using <span class="tooltip-trigger" aria-describedby="tooltip-rag-5">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-5">Retrieval-Augmented Generation</span></span> [4]: <span class="tooltip-trigger" aria-describedby="tooltip-chromadb-1">ChromaDB<span class="tooltip" role="tooltip" id="tooltip-chromadb-1">Vector Database</span></span> [13] stores context (docs, stats) embedded via Google/HF models [26, 27]. Llama 3.1 [14] on <span class="tooltip-trigger" aria-describedby="tooltip-groq-1">Groq<span class="tooltip" role="tooltip" id="tooltip-groq-1">Fast LLM Inference API</span></span> [15] generates answers based on retrieved context, enabling natural language queries.</p>
             </div>

             <div class="card" data-animate>
                 <h3><i class="fas fa-server" aria-hidden="true"></i>G. Deployment Architecture</h3>
                  <p>Modern stack: <span class="tooltip-trigger" aria-describedby="tooltip-fastapi-1">FastAPI<span class="tooltip" role="tooltip" id="tooltip-fastapi-1">Python Backend Framework</span></span> [16] backend on <span class="tooltip-trigger" aria-describedby="tooltip-railway">Railway<span class="tooltip" role="tooltip" id="tooltip-railway">Cloud Platform</span></span> [28], Responsive frontend on <span class="tooltip-trigger" aria-describedby="tooltip-vercel">Vercel<span class="tooltip" role="tooltip" id="tooltip-vercel">Cloud Platform</span></span> [17], persistent <span class="tooltip-trigger" aria-describedby="tooltip-chromadb-2">ChromaDB<span class="tooltip" role="tooltip" id="tooltip-chromadb-2">Vector Database</span></span> [13], <span class="tooltip-trigger" aria-describedby="tooltip-groq-2">Groq<span class="tooltip" role="tooltip" id="tooltip-groq-2">Fast LLM Inference API</span></span> [15] for <span class="tooltip-trigger" aria-describedby="tooltip-llm-3">LLM<span class="tooltip" role="tooltip" id="tooltip-llm-3">Large Language Model</span></span>.</p>
                   <div class="grid-container grid-cols-3"> <!-- Becomes 2 columns then 1 column on mobile -->
                      <!-- Ensure paths are correct -->
                      <figure id="fig10"><img src="assets/fig10_gridoracle.png" alt="Figure 10: Screenshot of the GridOracle Prediction Tool interface showing input fields (date, temp, holiday) and predicted demand output" onclick="openModal(this)" tabindex="0"><figcaption>Fig 10: GridOracle Tool</figcaption></figure>
                      <figure id="fig11"><img src="assets/fig11_dashboard.png" alt="Figure 11: Screenshot of the Visualization Dashboard showing time series charts of demand, generation, and temperature" onclick="openModal(this)" tabindex="0"><figcaption>Fig 11: Insights Dashboard</figcaption></figure>
                      <figure id="fig12"><img src="assets/fig12_chatbot.png" alt="Figure 12: Screenshot of the GridGenius Chatbot interface showing a user query and an LLM-generated explanation" onclick="openModal(this)" tabindex="0"><figcaption>Fig 12: GridGenius Chatbot</figcaption></figure>
                   </div>
            </div>
        </section>

         <hr class="section-divider">

        <!-- Results Section -->
        <section id="results">
            <h2 data-animate><i class="fas fa-chart-pie" aria-hidden="true"></i>Results and Experiments</h2>
              <div class="card" data-animate>
                 <h3><i class="fas fa-vial" aria-hidden="true"></i>A. Experimental Setup & Tools</h3>
                 <p>Hybrid setup (Colab T4 <span class="tooltip-trigger" aria-describedby="tooltip-gpu">GPU<span class="tooltip" role="tooltip" id="tooltip-gpu">Graphics Processing Unit</span></span>, RTX 3060, M1 Mac). Libs: Sklearn [18], TF [19]/Keras [21], PyTorch [20], NumPy [22], Pandas [23], Matplotlib [24]/Seaborn [25], <span class="tooltip-trigger" aria-describedby="tooltip-fastapi-2">FastAPI<span class="tooltip" role="tooltip" id="tooltip-fastapi-2">Python Backend Framework</span></span> [16], <span class="tooltip-trigger" aria-describedby="tooltip-chromadb-3">Chroma<span class="tooltip" role="tooltip" id="tooltip-chromadb-3">Vector Database</span></span> [13], etc.</p>
             </div>
              <div class="card" data-animate>
                 <h3><i class="fas fa-ruler-combined" aria-hidden="true"></i>B. Evaluation Metrics</h3>
                 <p>Measured by <span class="tooltip-trigger" aria-describedby="tooltip-r2-2">R²<span class="tooltip" role="tooltip" id="tooltip-r2-2">Coefficient of Determination</span></span>, <span class="tooltip-trigger" aria-describedby="tooltip-mae">MAE<span class="tooltip" role="tooltip" id="tooltip-mae">Mean Absolute Error</span></span>, <span class="tooltip-trigger" aria-describedby="tooltip-mse-2">MSE<span class="tooltip" role="tooltip" id="tooltip-mse-2">Mean Squared Error</span></span>, <span class="tooltip-trigger" aria-describedby="tooltip-rmse">RMSE<span class="tooltip" role="tooltip" id="tooltip-rmse">Root Mean Squared Error</span></span>.</p>
             </div>
             <div class="card" data-animate>
                 <h3><i class="fas fa-trophy" aria-hidden="true"></i>C. Overall Model Performance</h3>
                 <p>Random Forest & XGBoost excelled among classical models (R² ≈ 0.90).</p>
                 <div class="chart-container" style="min-height: 300px; height: 350px;"> <!-- Adjusted height -->
                    <canvas id="modelPerformanceChart" role="img" aria-label="Bar chart comparing R² scores: Random Forest (0.898), XGBoost (0.895), Transformer (0.82), Linear Regression (0.85)"></canvas>
                 </div>
                 <div class="table-container">
                     <table>
                          <caption>Table III: Detailed Evaluation (Best Model Per Variant)</caption>
                            <thead><tr><th>Dataset Variant</th><th>Best Model</th><th>R²</th><th>MAE</th><th>RMSE</th></tr></thead>
                            <tbody>
                                <tr><td>GGDataset_a (MinMax + IQR)</td><td>Random Forest</td><td>0.898</td><td>0.046</td><td>0.065</td></tr>
                                <tr><td>GGDataset_b (MinMax + Z-Score)</td><td>Random Forest</td><td>0.892</td><td>0.048</td><td>0.067</td></tr>
                                <tr><td>GGDataset_c (StdScaler + IQR)</td><td>Random Forest</td><td>0.898</td><td>0.226</td><td>0.313</td></tr>
                                <tr><td>GGDataset_d (StdScaler + Z-Score)</td><td>Random Forest</td><td>0.894</td><td>0.227</td><td>0.318</td></tr>
                            </tbody>
                     </table>
                 </div>
                  <div class="grid-container grid-cols-2"> <!-- Becomes 1 column on mobile -->
                      <!-- Ensure paths are correct -->
                      <figure id="fig13"><img src="assets/fig13_rf_results.png" alt="Figure 13: Plot showing Random Forest predicted demand (Y-axis) vs actual demand (X-axis), points cluster closely around the diagonal line indicating good fit" onclick="openModal(this)" tabindex="0"><figcaption>Fig 13: Random Forest Perf.</figcaption></figure>
                      <figure id="fig14"><img src="assets/fig14_xgb_results.png" alt="Figure 14: Plot showing XGBoost predicted demand (Y-axis) vs actual demand (X-axis), similar good fit to Random Forest" onclick="openModal(this)" tabindex="0"><figcaption>Fig 14: XGBoost Perf.</figcaption></figure>
                  </div>
             </div>
              <div class="card" data-animate>
                 <h3><i class="fas fa-sliders-h" aria-hidden="true"></i>D. Hyperparameter Tuning</h3>
                 <p><code>RandomizedSearchCV</code> significantly boosted RF/XGBoost performance.</p>
             </div>
             <div class="card" data-animate>
                 <h3><i class="fas fa-brain" aria-hidden="true"></i>E. Transformer Model Results</h3>
                  <p>Strong generalization (R² ≈ 0.82).</p>
                  <div class="metrics-grid"> <!-- Becomes 2 columns then 1 column on mobile -->
                      <div class="metric-card"><div class="metric-name">R² Score</div><div class="metric-value">≈ 0.82</div></div>
                      <div class="metric-card"><div class="metric-name">MAE</div><div class="metric-value">≈ 0.06*</div></div>
                      <div class="metric-card"><div class="metric-name">RMSE</div><div class="metric-value">≈ 0.08*</div></div>
                  </div>
                   <div class="grid-container grid-cols-2"> <!-- Becomes 1 column on mobile -->
                     <!-- Ensure paths are correct -->
                     <figure id="fig15"><img src="assets/fig15_transformer_results.png" alt="Figure 15: Plot showing Transformer predicted demand (Y-axis) vs actual demand (X-axis), points show good correlation but slightly more scatter than RF/XGBoost" onclick="openModal(this)" tabindex="0"><figcaption>Fig 15: Transformer Perf.</figcaption></figure>
                     <figure id="fig16"><img src="assets/fig16_transformer_loss.png" alt="Figure 16: Plot showing Transformer training and validation loss curves decreasing over epochs, indicating learning" onclick="openModal(this)" tabindex="0"><figcaption>Fig 16: Transformer Loss</figcaption></figure>
                 </div>
                  <p style="font-size: 0.85rem; color: var(--text-secondary);">*MAE/RMSE likely reported on scaled data.</p>
             </div>
              <div class="card" data-animate>
                 <h3><i class="fas fa-adjust" aria-hidden="true"></i>F. Ablation Study: Scaling</h3>
                  <p>MinMaxScaler slightly better for classical models; Transformer less sensitive. Z-score impact minimal vs <span class="tooltip-trigger" aria-describedby="tooltip-iqr-2">IQR<span class="tooltip" role="tooltip" id="tooltip-iqr-2">Interquartile Range</span></span> for outlier handling.</p>
             </div>
             <div class="card" data-animate>
                 <h3><i class="fas fa-comment-dots" aria-hidden="true"></i>G. XAI Chatbot Results</h3>
                  <p><span class="tooltip-trigger" aria-describedby="tooltip-rag-6">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-6">Retrieval-Augmented Generation</span></span> chatbot effectively answered complex queries in real-time (<1s latency via <span class="tooltip-trigger" aria-describedby="tooltip-groq-3">Groq<span class="tooltip" role="tooltip" id="tooltip-groq-3">Fast LLM Inference API</span></span>), enhancing transparency.</p>
             </div>
        </section>

        <hr class="section-divider">

        <!-- Conclusion Section -->
        <section id="conclusion">
            <h2 data-animate><i class="fas fa-flag-checkered" aria-hidden="true"></i>Conclusion and Future Work</h2>
            <p data-animate>GridGenius presents a significant advancement in energy demand forecasting for Bangladesh. By integrating a novel dataset, hybrid modeling, and an interactive <span class="tooltip-trigger" aria-describedby="tooltip-rag-7">RAG<span class="tooltip" role="tooltip" id="tooltip-rag-7">Retrieval-Augmented Generation</span></span>-based <span class="tooltip-trigger" aria-describedby="tooltip-xai-4">XAI<span class="tooltip" role="tooltip" id="tooltip-xai-4">Explainable Artificial Intelligence</span></span> system, it addresses key limitations. The platform achieves high accuracy (R² ≈ 0.89) and offers unprecedented transparency.</p>
             <p data-animate>The deployed system provides a practical, scalable tool for grid planners, offering a blueprint for intelligent energy management in developing economies.</p>

             <div class="accordion-item" data-animate>
                 <div class="accordion-header" id="accordion-header-2">
                    <button class="accordion-button" aria-expanded="false" aria-controls="accordion-content-2">
                        <h4><i class="fas fa-arrow-alt-circle-right" aria-hidden="true"></i> Future Work Directions<small>(Click to Expand)</small></h4>
                         <i class="fas fa-chevron-down accordion-icon" aria-hidden="true"></i>
                     </button>
                 </div>
                 <div class="accordion-content" id="accordion-content-2" role="region" aria-labelledby="accordion-header-2">
                     <ul>
                          <li><strong>Data Expansion:</strong> Seek pre-2020 BPDB data.</li>
                          <li><strong>Model Refinement:</strong> Optimize Transformer (tuning, TCNs [30], Informer [31], multivariate attention [32]).</li>
                          <li><strong><span class="tooltip-trigger" aria-describedby="tooltip-llm-4">LLM<span class="tooltip" role="tooltip" id="tooltip-llm-4">Large Language Model</span></span> Enhancement:</strong> Improve RAG (prompts, retrieval, <span class="tooltip-trigger" aria-describedby="tooltip-lora">LoRA<span class="tooltip" role="tooltip" id="tooltip-lora">Low-Rank Adaptation</span></span> [29]).</li>
                          <li><strong>Feature Integration:</strong> Add economic/operational data.</li>
                          <li><strong>Platform Evolution:</strong> Mobile-first UI, public <span class="tooltip-trigger" aria-describedby="tooltip-apis">APIs<span class="tooltip" role="tooltip" id="tooltip-apis">Application Programming Interface</span></span>.</li>
                      </ul>
                 </div>
             </div>
        </section>

        <hr class="section-divider">

        <!-- References Section -->
        <section id="references">
            <h2 data-animate><i class="fas fa-book" aria-hidden="true"></i>References</h2>
            <div class="card" data-animate>
                <ol>
                    <!-- References remain the same -->
                    <li>Bangladesh Power Development Board, "Bangladesh Power Development Board," [Online]. Available: <a href="https://www.bpdb.gov.bd/" target="_blank" rel="noopener noreferrer">https://www.bpdb.gov.bd/</a>.</li>
                    <li>A. Vaswani, et al., "Attention Is All You Need," arXiv:1706.03762, 2017. [Online]. Available: <a href="https://arxiv.org/abs/1706.03762" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/1706.03762</a>.</li>
                    <li>G. P. Reddy and Y. V. P. Kumar, "Explainable AI (XAI): Explained," 2023 IEEE eStream, pp. 1-6, doi: 10.1109/eStream59056.2023.10134984.</li>
                    <li>P. Lewis, et al., "Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks," arXiv:2005.11401, 2020. [Online]. Available: <a href="https://arxiv.org/abs/2005.11401" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2005.11401</a>.</li>
                    <li>M. Hossain, et al., "Short-Term Electricity Demand Forecasting of Dhaka City Using Machine Learning Approaches," arXiv:2406.06651, 2024.</li>
                    <li>Y. Wang, et al., "Short-term power load forecasting using SSA-CNN-LSTM method," Syst. Sci. Control Eng., vol. 12, no. 1, pp. 1-12, 2024. doi: 10.1080/21642583.2024.2343297.</li>
                    <li>H. Haque and M. A. Razzak, "Medium-Term Energy Demand Analysis Using Machine Learning," SSRN Electron. J., Aug. 2022. doi: 10.2139/ssrn.4197655.</li>
                    <li>H. Haque, et al., "Long-term Energy Demand Analysis using Machine Learning Algorithms," 2024 6th Int. Conf. SGRE, pp. 1-6. doi: 10.1109/SGRE60102.2024.10815643.</li>
                    <li>Q. Wen, et al., "Transformers in Time Series: A Survey," arXiv:2202.07125, 2022. [Online]. Available: <a href="https://arxiv.org/abs/2202.07125" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2202.07125</a>.</li>
                    <li>H. Wu, et al., "Autoformer: Decomposition Transformers with Auto-Correlation for Long-Term Series Forecasting," arXiv:2106.13008, 2021. [Online]. Available: <a href="https://arxiv.org/abs/2106.13008" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2106.13008</a>.</li>
                    <li>IBM, "Using the watsonx.ai Time Series Forecasting API to predict energy demand," IBM Developer, 2025. [Online]. Available: <a href="https://developer.ibm.com/tutorials/time-series-api-watsonx-ai/" target="_blank" rel="noopener noreferrer">Link</a>.</li>
                    <li>D. P. Kingma and J. Ba, "Adam: A Method for Stochastic Optimization," arXiv:1412.6980, 2014. [Online]. Available: <a href="https://arxiv.org/abs/1412.6980" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/1412.6980</a>.</li>
                    <li>Chroma, "Chroma: The AI-native open-source embedding database," GitHub, 2023. [Online]. Available: <a href="https://github.com/chroma-core/chroma" target="_blank" rel="noopener noreferrer">https://github.com/chroma-core/chroma</a>.</li>
                    <li>Meta AI, "Introducing Llama 3.1," Meta AI Blog, 2024. [Online]. Available: <a href="https://ai.meta.com/blog/meta-llama-3-1/" target="_blank" rel="noopener noreferrer">https://ai.meta.com/blog/meta-llama-3-1/</a>.</li>
                    <li>Groq, "GroqCloud: Fast AI Inference," 2024. [Online]. Available: <a href="https://groq.com/" target="_blank" rel="noopener noreferrer">https://groq.com/</a>.</li>
                    <li>S. Ramírez, "FastAPI," 2023. [Online]. Available: <a href="https://fastapi.tiangolo.com/" target="_blank" rel="noopener noreferrer">https://fastapi.tiangolo.com/</a>.</li>
                    <li>Vercel, "Vercel Documentation," 2024. [Online]. Available: <a href="https://vercel.com/docs" target="_blank" rel="noopener noreferrer">https://vercel.com/docs</a>.</li>
                    <li>F. Pedregosa, et al., "Scikit-learn: Machine Learning in Python," JMLR, vol. 12, pp. 2825-2830, 2011.</li>
                    <li>M. Abadi, et al., "TensorFlow: Large-scale machine learning on heterogeneous systems," arXiv:1603.04467, 2016. [Online]. Available: <a href="https://arxiv.org/abs/1603.04467" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/1603.04467</a>.</li>
                    <li>A. Paszke, et al., "PyTorch: An Imperative Style, High-Performance Deep Learning Library," NeurIPS, 2019.</li>
                    <li>F. Chollet, "Keras," GitHub, 2015. [Online]. Available: <a href="https://github.com/keras-team/keras" target="_blank" rel="noopener noreferrer">https://github.com/keras-team/keras</a>.</li>
                    <li>C. R. Harris, et al., "Array programming with NumPy," Nature, vol. 585, pp. 357-362, 2020.</li>
                    <li>W. McKinney, "Data Structures for Statistical Computing in Python," Proc. 9th Python Sci. Conf., 2010, pp. 51-56.</li>
                    <li>J. D. Hunter, "Matplotlib: A 2D Graphics Environment," Comput. Sci. Eng., vol. 9, no. 3, pp. 90-95, 2007.</li>
                    <li>M. Waskom, "Seaborn: Statistical Data Visualization," J. Open Source Softw., vol. 6, no. 60, p. 3021, 2021.</li>
                    <li>Google, "Google Cloud AI Platform," 2024. [Online]. Available: <a href="https://cloud.google.com/ai-platform" target="_blank" rel="noopener noreferrer">https://cloud.google.com/ai-platform</a>.</li>
                    <li>Hugging Face, "Hugging Face Transformers," 2024. [Online]. Available: <a href="https://huggingface.co/transformers/" target="_blank" rel="noopener noreferrer">https://huggingface.co/transformers/</a>.</li>
                    <li>Railway, "Railway: Infrastructure for Developers," 2024. [Online]. Available: <a href="https://railway.app/" target="_blank" rel="noopener noreferrer">https://railway.app/</a>.</li>
                    <li>E. Hu, et al., "LoRA: Low-Rank Adaptation of Large Language Models," arXiv:2106.09685, 2021. [Online]. Available: <a href="https://arxiv.org/abs/2106.09685" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2106.09685</a>.</li>
                    <li>S. Bai, et al., "An Empirical Evaluation of Generic Convolutional and Recurrent Networks for Sequence Modeling," arXiv:1803.01271, 2018. [Online]. Available: <a href="https://arxiv.org/abs/1803.01271" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/1803.01271</a>.</li>
                    <li>H. Zhou, et al., "Informer: Beyond Efficient Transformer for Long Sequence Time-Series Forecasting," AAAI, 2021. [Online]. Available: <a href="https://arxiv.org/abs/2012.07436" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2012.07436</a>.</li>
                    <li>H. Wu, "Revisiting Attention for Multivariate Time Series Forecasting," arXiv:2407.13806, 2024. [Online]. Available: <a href="https://arxiv.org/abs/2407.13806" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/2407.13806</a>.</li>
                </ol>
            </div>
        </section>

    </main>

     <footer>
         <div class="container footer-content">
             <a href="#" class="footer-logo" aria-label="GridGenius Homepage">GridGenius, © 2025 Adib Ar Rahman Khan, Aurongojeb Lishad, Pranoy Saha, Sadia Islam Mou.</a>
         </div>
     </footer>

    <!-- Image Modal Structure - Enhanced A11y -->
     <div id="imageModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalCaption" onclick="closeModal(event)">
         <button class="modal-close" onclick="closeModal(event)" aria-label="Close image modal">×</button>
         <div class="modal-image-wrapper">
            <img class="modal-content" id="modalImageContent" alt=""> <!-- Alt populated by JS -->
         </div>
         <div class="modal-caption" id="modalCaption"></div> <!-- Caption populated by JS -->
     </div>

    <script>
        // Javascript remains largely the same as provided in the initial prompt,
        // as it correctly handles toggles, scrolls, animations (with observer),
        // modal opening/closing, accordions, and chart initialization.
        // The responsiveness fixes are primarily CSS-driven.

        document.addEventListener('DOMContentLoaded', () => {

            const isMobile = () => window.innerWidth <= 768;
            let focusedElementBeforeModal = null; // To store focus before modal opens

            // --- Mobile Menu Toggle ---
            const menuButton = document.getElementById('mobile-menu-toggle');
            const navLinksList = document.getElementById('nav-links-list');
            const menuIcon = menuButton?.querySelector('i'); // Cache the icon

            if (menuButton && navLinksList && menuIcon) {
                menuButton.addEventListener('click', () => {
                    const isExpanded = menuButton.getAttribute('aria-expanded') === 'true';
                    navLinksList.classList.toggle('mobile-nav-open');
                    menuButton.setAttribute('aria-expanded', String(!isExpanded)); // Set ARIA explicitly
                    menuIcon.classList.toggle('fa-bars');
                    menuIcon.classList.toggle('fa-times');

                    // Optional: Trap focus within the mobile menu when open
                    // This is more complex, involving finding first/last focusable items
                    // For simplicity, basic toggle is kept here.
                });

                // Close menu when a link is clicked (important for SPA-like behavior)
                navLinksList.querySelectorAll('a').forEach(link => {
                     link.addEventListener('click', () => {
                         if (navLinksList.classList.contains('mobile-nav-open')) { // Only if menu is open
                              navLinksList.classList.remove('mobile-nav-open');
                              menuButton.setAttribute('aria-expanded', 'false');
                              menuIcon.classList.remove('fa-times');
                              menuIcon.classList.add('fa-bars');
                         }
                     });
                 });
                 // Close menu if user clicks outside of it (optional)
                 document.addEventListener('click', (event) => {
                    if (!menuButton.contains(event.target) && !navLinksList.contains(event.target) && navLinksList.classList.contains('mobile-nav-open')) {
                         navLinksList.classList.remove('mobile-nav-open');
                         menuButton.setAttribute('aria-expanded', 'false');
                         menuIcon.classList.remove('fa-times');
                         menuIcon.classList.add('fa-bars');
                    }
                 });
            }


            // --- Back To Top Button ---
            const backToTopButton = document.querySelector('.back-to-top');
             if (backToTopButton) {
                 window.addEventListener('scroll', () => {
                     backToTopButton.classList.toggle('visible', window.scrollY > 300);
                 }, { passive: true }); // Use passive listener

                 backToTopButton.addEventListener('click', (e) => {
                     e.preventDefault();
                     window.scrollTo({ top: 0, behavior: 'smooth' });
                 });
             }

            // --- Navbar Highlighting ---
            const sections = document.querySelectorAll("section[id]");
            const navLinkAnchors = document.querySelectorAll(".nav-links a");
            const navHeight = document.querySelector('.navbar')?.offsetHeight || 65; // Use defined var or fallback

            function updateActiveNav() {
                if (!navLinkAnchors.length) return; // Don't run if no nav links found

                let current = "";
                const scrollPosition = window.pageYOffset + navHeight * 1.5; // Adjusted offset for earlier detection

                 sections.forEach((section) => {
                     const sectionTop = section.offsetTop;
                     if (scrollPosition >= sectionTop) { // If we've passed the top of this section
                          current = section.getAttribute("id") || "";
                     }
                 });

                 // If scrolled to the very bottom, ensure the last section is active
                 if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 50) {
                    const lastSection = sections[sections.length - 1];
                    if (lastSection) current = lastSection.getAttribute("id") || "";
                 }

                 // Default to first link's target if no section is matched (e.g., at the top)
                 if (!current && navLinkAnchors.length > 0) {
                     const firstLinkHref = navLinkAnchors[0].getAttribute("href");
                     if (firstLinkHref && firstLinkHref.startsWith("#")) {
                         current = firstLinkHref.substring(1);
                     }
                 }


                navLinkAnchors.forEach((link) => {
                    const linkHref = link.getAttribute("href");
                    // Robust check: handles full URLs ending with #hash vs just #hash
                    const linkTargetId = linkHref ? (linkHref.includes('#') ? linkHref.substring(linkHref.lastIndexOf('#') + 1) : null) : null;

                    const isActive = linkTargetId === current;
                    link.classList.toggle("active", isActive);
                    link.setAttribute('aria-current', isActive ? 'page' : 'false');
                });
            }


            // --- Scroll Progress Bar ---
            const scrollProgress = document.querySelector('.scroll-progress');
            function updateScrollProgress() {
                 if (!scrollProgress) return;
                 const totalHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                 const scrolled = totalHeight > 0 ? (window.scrollY / totalHeight) * 100 : 0;
                 // Ensure value is between 0 and 100
                 const progressWidth = Math.max(0, Math.min(100, scrolled));
                 scrollProgress.style.width = `${progressWidth}%`;
            }

            // Combined Scroll Listener (Throttled using requestAnimationFrame)
            let isScrolling = false;
            window.addEventListener("scroll", () => {
                if (!isScrolling) {
                    window.requestAnimationFrame(() => {
                        updateActiveNav();
                        updateScrollProgress();
                        isScrolling = false;
                    });
                    isScrolling = true;
                }
            }, { passive: true });

            // Initial calls
            updateActiveNav();
            updateScrollProgress();


            // --- Animated Counters ---
            const counters = document.querySelectorAll('.counter-value');
            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

            const animateCounter = (counter) => {
                const target = +counter.getAttribute('data-target');
                if (isNaN(target)) return;

                if (prefersReducedMotion) {
                    counter.innerText = target.toLocaleString(); // Set final value directly
                    return;
                }

                let count = 0;
                counter.innerText = '0';
                const duration = 1500; // Fixed duration for simplicity
                let startTime = null;

                const step = (timestamp) => {
                    if (!startTime) startTime = timestamp;
                    const progress = Math.min((timestamp - startTime) / duration, 1);
                    count = Math.floor(progress * target);
                    counter.innerText = count.toLocaleString();
                    if (progress < 1) {
                        requestAnimationFrame(step);
                    } else {
                        counter.innerText = target.toLocaleString(); // Ensure final exact value
                    }
                };
                requestAnimationFrame(step);
             };


            // --- Scroll Animations (Intersection Observer) ---
             const animatedElements = document.querySelectorAll('[data-animate]');
             const animateObserverOptions = { root: null, threshold: 0.1, rootMargin: "0px 0px -40px 0px" };

             if ("IntersectionObserver" in window) {
                 const animateObserver = new IntersectionObserver((entries, observer) => {
                     entries.forEach(entry => {
                         if (entry.isIntersecting) {
                             entry.target.classList.add('visible');

                             // Check if the element contains a counter that hasn't been animated
                             const counterElement = entry.target.querySelector('.counter-value:not([data-animated="true"])');
                             if (counterElement) {
                                 animateCounter(counterElement);
                                 counterElement.setAttribute('data-animated', 'true'); // Mark as animated
                             }
                             observer.unobserve(entry.target); // Stop observing once visible
                         }
                     });
                 }, animateObserverOptions);

                  animatedElements.forEach(el => animateObserver.observe(el));
             } else {
                 // Fallback for older browsers
                 console.warn("IntersectionObserver not supported, scroll animations disabled.");
                 animatedElements.forEach(el => el.classList.add('visible'));
                 counters.forEach(counter => { // Directly set counter values in fallback
                    const target = +counter.getAttribute('data-target');
                    if (!isNaN(target) && !counter.hasAttribute('data-animated')) {
                         counter.innerText = target.toLocaleString();
                         counter.setAttribute('data-animated', 'true');
                    }
                 });
             }


            // --- Image Modal ---
            const modal = document.getElementById("imageModal");
            const modalImg = document.getElementById("modalImageContent");
            const captionText = document.getElementById("modalCaption");
            const modalCloseButton = modal?.querySelector('.modal-close');

            function trapFocus(e) {
                if (!modal || !modal.classList.contains('visible')) return;
                let isTabPressed = e.key === 'Tab' || e.keyCode === 9;
                if (!isTabPressed) return;

                const focusableModalElements = modal.querySelectorAll(
                     'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), img[tabindex="0"]'
                 );
                if (focusableModalElements.length === 0) return;
                const firstFocusableElement = focusableModalElements[0];
                const lastFocusableElement = focusableModalElements[focusableModalElements.length - 1];

                if (e.shiftKey) { // Shift + Tab
                     if (document.activeElement === firstFocusableElement) {
                         lastFocusableElement?.focus(); e.preventDefault();
                     }
                 } else { // Tab
                     if (document.activeElement === lastFocusableElement) {
                         firstFocusableElement?.focus(); e.preventDefault();
                     }
                 }
            }

            if (modal && modalImg && captionText && modalCloseButton) {
                 window.openModal = function(imgElement) {
                    if (!imgElement || !imgElement.src) return;
                    focusedElementBeforeModal = document.activeElement;

                    modal.style.display = "flex"; // Make container visible
                    modalImg.src = imgElement.src;
                    const altText = imgElement.getAttribute('alt') || "Enlarged image";
                    captionText.innerHTML = altText;
                    modalImg.setAttribute('alt', altText);

                    requestAnimationFrame(() => { modal.classList.add('visible'); }); // Add class for fade-in

                    document.body.style.overflow = 'hidden';
                    modalCloseButton.focus();
                    document.addEventListener('keydown', trapFocus);
                    document.addEventListener('keydown', handleEscKey); // Add ESC listener
                }

                 window.closeModal = function(event) {
                     if (!modal.classList.contains('visible')) return;
                     // Close only if backdrop (modal itself) or close button is clicked directly
                     if (event && event.target !== modal && event.target !== modalCloseButton) {
                         // If the click was inside the modal but not on the close button, do nothing
                         // This check prevents clicks on the image/caption from closing the modal
                         if (modal.querySelector('.modal-image-wrapper')?.contains(event.target) || captionText.contains(event.target)) {
                              return;
                         }
                     }

                     modal.classList.remove('visible');
                     document.body.style.overflow = 'auto';
                     document.removeEventListener('keydown', trapFocus);
                     document.removeEventListener('keydown', handleEscKey); // Remove ESC listener

                     // Wait for fade out transition before hiding and restoring focus
                     modal.addEventListener('transitionend', () => {
                         modal.style.display = "none";
                         focusedElementBeforeModal?.focus();
                         focusedElementBeforeModal = null;
                     }, { once: true });
                 }

                 // Separate ESC key handler
                 const handleEscKey = (e) => {
                     if (e.key === "Escape") {
                         closeModal(null); // Pass null event
                     }
                 };

                 // Direct click listener for close button
                 modalCloseButton.addEventListener('click', () => closeModal(null));

                 // Backdrop click is handled by the onclick attribute on the modal div itself


            } else {
                 console.error("Modal elements not found!");
                 window.openModal = function() { console.error("Modal cannot open, elements missing."); };
                 window.closeModal = function() {};
            }


            // --- Accordion ---
            const accordionButtons = document.querySelectorAll('.accordion-button');
             accordionButtons.forEach(button => {
                 const content = document.getElementById(button.getAttribute('aria-controls'));
                 if (!content) return;

                 button.addEventListener('click', () => {
                     const isExpanded = button.getAttribute('aria-expanded') === 'true';
                     button.setAttribute('aria-expanded', String(!isExpanded));

                     if (!isExpanded) { // Opening
                         content.classList.add('active');
                         content.style.maxHeight = content.scrollHeight + "px";
                         // Recalculate after potential style changes settle
                         requestAnimationFrame(() => {
                            content.style.maxHeight = content.scrollHeight + "px";
                         });
                     } else { // Closing
                         // Set max-height explicitly before transitioning to 0
                         content.style.maxHeight = content.scrollHeight + "px";
                         requestAnimationFrame(() => { // Needed for transition to trigger correctly
                            content.style.maxHeight = "0px";
                         });
                         // Remove active class after transition
                         content.addEventListener('transitionend', () => {
                             content.classList.remove('active');
                         }, { once: true });
                     }
                 });

                 // Ensure content is collapsed initially if button starts as collapsed
                 if (button.getAttribute('aria-expanded') === 'false') {
                      content.style.maxHeight = "0px";
                      content.classList.remove('active');
                 } else {
                      content.classList.add('active');
                      content.style.maxHeight = content.scrollHeight + "px"; // Set initial height if open
                 }
             });


            // --- Tooltip Accessibility (Focus Handling) ---
            document.querySelectorAll('.tooltip-trigger').forEach(trigger => {
                 const tooltip = document.getElementById(trigger.getAttribute('aria-describedby'));
                 if (tooltip) {
                     const showTooltip = () => tooltip.classList.add('visible-focus');
                     const hideTooltip = () => tooltip.classList.remove('visible-focus');
                     trigger.addEventListener('focus', showTooltip);
                     trigger.addEventListener('blur', hideTooltip);
                 }
            });

            // --- Chart.js Initialization ---
             try {
                const styles = getComputedStyle(document.documentElement);
                const chartYellow = styles.getPropertyValue('--accent-yellow').trim() || '#fde047';
                const chartYellowDark = styles.getPropertyValue('--accent-yellow-dark').trim() || '#facc15';
                const chartBlue = styles.getPropertyValue('--accent-blue').trim() || '#60a5fa';
                const chartBorder = styles.getPropertyValue('--border-color').trim() || '#3a3a3c';
                const chartTextPrimary = styles.getPropertyValue('--text-primary').trim() || '#f0f0f0';
                const chartTextSecondary = styles.getPropertyValue('--text-secondary').trim() || '#b0b0b5';
                const chartGridColor = 'rgba(255, 255, 255, 0.1)';
                const chartBgNeutral = 'rgba(60, 60, 62, 0.7)';
                const chartAnimation = prefersReducedMotion ? false : { duration: 800 }; // Use shared animation setting

                // R2 Score Chart (Inside Counter Card)
                const r2Canvas = document.getElementById('r2ScoreChart');
                if (r2Canvas && Chart) {
                    const r2Ctx = r2Canvas.getContext('2d');
                    if (r2Ctx) {
                         // Define gradient background for doughnut chart
                         const gradientBg = r2Ctx.createLinearGradient(0, 0, 0, r2Canvas.height);
                         gradientBg.addColorStop(0, `rgba(${parseInt(chartYellowDark.slice(1,3),16)}, ${parseInt(chartYellowDark.slice(3,5),16)}, ${parseInt(chartYellowDark.slice(5,7),16)}, 0.9)`);
                         gradientBg.addColorStop(1, `rgba(${parseInt(chartYellow.slice(1,3),16)}, ${parseInt(chartYellow.slice(3,5),16)}, ${parseInt(chartYellow.slice(5,7),16)}, 0.75)`);

                        new Chart(r2Ctx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Achieved R²', 'Remaining'],
                                datasets: [{
                                    data: [89, 11], // Example: 89% achieved
                                    backgroundColor: [gradientBg, chartBgNeutral],
                                    borderColor: [chartYellowDark, chartBorder],
                                    borderWidth: 1,
                                    circumference: 180, // Semi-circle
                                    rotation: 270      // Start from bottom
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false, // Important for small containers
                                cutout: '70%', // Adjust thickness
                                plugins: { legend: { display: false }, tooltip: { enabled: false } }, // Simpler tooltip for counter
                                animation: chartAnimation
                            }
                        });
                    } else { console.error("Chart.js: Failed to get 2D context for #r2ScoreChart"); }
                } else if (!Chart) { console.error("Chart.js library not loaded."); }

                // Model Performance Chart
                const perfCanvas = document.getElementById('modelPerformanceChart');
                if (perfCanvas && Chart) {
                    const perfCtx = perfCanvas.getContext('2d');
                    if (perfCtx) {
                        new Chart(perfCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Random Forest', 'XGBoost', 'Transformer', 'Linear Reg.'],
                                datasets: [{
                                    label: 'R² Score', data: [0.898, 0.895, 0.82, 0.85], // Example data
                                    backgroundColor: [
                                        `rgba(${parseInt(chartYellowDark.slice(1,3),16)}, ${parseInt(chartYellowDark.slice(3,5),16)}, ${parseInt(chartYellowDark.slice(5,7),16)}, 0.8)`,
                                        `rgba(${parseInt(chartYellow.slice(1,3),16)}, ${parseInt(chartYellow.slice(3,5),16)}, ${parseInt(chartYellow.slice(5,7),16)}, 0.75)`,
                                        `rgba(${parseInt(chartBlue.slice(1,3),16)}, ${parseInt(chartBlue.slice(3,5),16)}, ${parseInt(chartBlue.slice(5,7),16)}, 0.75)`,
                                        'rgba(180, 180, 185, 0.7)'
                                    ],
                                    borderColor: [ chartYellowDark, chartYellow, chartBlue, chartTextSecondary ],
                                    borderWidth: 1, borderRadius: 4
                                }]
                            },
                            options: {
                                responsive: true, maintainAspectRatio: false, indexAxis: 'y', // Horizontal bars often better on mobile
                                scales: {
                                    x: { beginAtZero: true, max: 1, grid: { color: chartGridColor, borderColor: chartBorder }, ticks: { color: chartTextSecondary, font: { size: 11 } } },
                                    y: { grid: { display: false, borderColor: chartBorder }, ticks: { color: chartTextPrimary, font: { size: 12 } } }
                                },
                                plugins: {
                                    legend: { display: false },
                                    title: { display: true, text: 'Model R² Score Comparison', color: chartTextPrimary, padding: { bottom: 15 }, font: { size: 14, weight: '500' } }, // Slightly smaller title
                                    tooltip: {
                                        enabled: true,
                                        backgroundColor: 'rgba(0,0,0,0.8)', titleFont: { size: 13 }, bodyFont: { size: 12 }
                                    }
                                },
                                animation: chartAnimation
                            }
                        });
                    } else { console.error("Chart.js: Failed to get 2D context for #modelPerformanceChart"); }
                } else if (!Chart) { console.error("Chart.js library not loaded."); }

             } catch (error) { console.error("Chart.js Initialization Error:", error); }


        }); // --- END DOMContentLoaded ---
    </script>

</body>
</html>
